[
  {
    "schemaVersion": "2.0",
    "accountId": "825685784137",
    "region": "us-west-2",
    "partition": "aws",
    "id": "66bc8ffab995853ff65bd9adcc92d44c",
    "arn": "arn:aws:guardduty:us-west-2:825685784137:detector/94bc8ff76cd1eb9df57aedd6c01c4235/finding/66bc8ffab995853ff65bd9adcc92d44c",
    "type": "UnauthorizedAccess:S3/MaliciousIPCaller.Custom",
    "resource": {
      "resourceType": "S3Bucket",
      "accessKeyDetails": {
        "accessKeyId": "GeneratedFindingAccessKeyId",
        "principalId": "GeneratedFindingPrincipalId",
        "userType": "IAMUser",
        "userName": "GeneratedFindingUserName"
      },
      "s3BucketDetails": [
        {
          "arn": "arn:aws:s3:::bucketName",
          "name": "bucketName",
          "type": "Destination",
          "createdAt": 1513612691.551,
          "owner": {
            "id": "CanonicalId of Owner"
          },
          "tags": [
            {
              "key": "foo",
              "value": "bar"
            }
          ],
          "defaultServerSideEncryption": {
            "encryptionType": "SSEAlgorithm",
            "kmsMasterKeyArn": "arn:aws:kms:region:123456789012:key/key-id"
          },
          "publicAccess": {
            "permissionConfiguration": {
              "bucketLevelPermissions": {
                "accessControlList": {
                  "allowsPublicReadAccess": false,
                  "allowsPublicWriteAccess": false
                },
                "bucketPolicy": {
                  "allowsPublicReadAccess": false,
                  "allowsPublicWriteAccess": false
                },
                "blockPublicAccess": {
                  "ignorePublicAcls": false,
                  "restrictPublicBuckets": false,
                  "blockPublicAcls": false,
                  "blockPublicPolicy": false
                }
              },
              "accountLevelPermissions": {
                "blockPublicAccess": {
                  "ignorePublicAcls": false,
                  "restrictPublicBuckets": false,
                  "blockPublicAcls": false,
                  "blockPublicPolicy": false
                }
              }
            },
            "effectivePermission": "NOT_PUBLIC"
          }
        }
      ],
      "instanceDetails": {
        "instanceId": "i-99999999",
        "instanceType": "m3.xlarge",
        "outpostArn": "arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3",
        "launchTime": "2016-08-02T02:05:06Z",
        "platform": null,
        "productCodes": [
          {
            "productCodeId": "GeneratedFindingProductCodeId",
            "productCodeType": "GeneratedFindingProductCodeType"
          }
        ],
        "iamInstanceProfile": {
          "arn": "arn:aws:iam::825685784137:example/instance/profile",
          "id": "GeneratedFindingInstanceProfileId"
        },
        "networkInterfaces": [
          {
            "ipv6Addresses": [],
            "networkInterfaceId": "eni-bfcffe88",
            "privateDnsName": "GeneratedFindingPrivateDnsName",
            "privateIpAddress": "10.0.0.1",
            "privateIpAddresses": [
              {
                "privateDnsName": "GeneratedFindingPrivateName",
                "privateIpAddress": "10.0.0.1"
              }
            ],
            "subnetId": "GeneratedFindingSubnetId",
            "vpcId": "GeneratedFindingVPCId",
            "securityGroups": [
              {
                "groupName": "GeneratedFindingSecurityGroupName",
                "groupId": "GeneratedFindingSecurityId"
              }
            ],
            "publicDnsName": "GeneratedFindingPublicDNSName",
            "publicIp": "198.51.100.0"
          }
        ],
        "tags": [
          {
            "key": "GeneratedFindingInstaceTag1",
            "value": "GeneratedFindingInstaceValue1"
          },
          {
            "key": "GeneratedFindingInstaceTag2",
            "value": "GeneratedFindingInstaceTagValue2"
          },
          {
            "key": "GeneratedFindingInstaceTag3",
            "value": "GeneratedFindingInstaceTagValue3"
          },
          {
            "key": "GeneratedFindingInstaceTag4",
            "value": "GeneratedFindingInstaceTagValue4"
          },
          {
            "key": "GeneratedFindingInstaceTag5",
            "value": "GeneratedFindingInstaceTagValue5"
          },
          {
            "key": "GeneratedFindingInstaceTag6",
            "value": "GeneratedFindingInstaceTagValue6"
          },
          {
            "key": "GeneratedFindingInstaceTag7",
            "value": "GeneratedFindingInstaceTagValue7"
          },
          {
            "key": "GeneratedFindingInstaceTag8",
            "value": "GeneratedFindingInstaceTagValue8"
          },
          {
            "key": "GeneratedFindingInstaceTag9",
            "value": "GeneratedFindingInstaceTagValue9"
          }
        ],
        "instanceState": "running",
        "availabilityZone": "GeneratedFindingInstaceAvailabilityZone",
        "imageId": "ami-99999999",
        "imageDescription": "GeneratedFindingInstaceImageDescription"
      }
    },
    "service": {
      "serviceName": "guardduty",
      "detectorId": "94bc8ff76cd1eb9df57aedd6c01c4235",
      "action": {
        "actionType": "AWS_API_CALL",
        "awsApiCallAction": {
          "api": "GeneratedFindingAPIName",
          "serviceName": "GeneratedFindingAPIServiceName",
          "callerType": "Remote IP",
          "errorCode": "AccessDenied",
          "remoteIpDetails": {
            "ipAddressV4": "198.51.100.0",
            "organization": {
              "asn": "-1",
              "asnOrg": "GeneratedFindingASNOrg",
              "isp": "GeneratedFindingISP",
              "org": "GeneratedFindingORG"
            },
            "country": {
              "countryName": "GeneratedFindingCountryName"
            },
            "city": {
              "cityName": "GeneratedFindingCityName"
            },
            "geoLocation": {
              "lat": 0,
              "lon": 0
            }
          },
          "affectedResources": {
            "AWS::S3::Bucket": "GeneratedFindingS3Bucket"
          }
        }
      },
      "resourceRole": "TARGET",
      "additionalInfo": {
        "unusual": {
          "hoursOfDay": [
            1513609200000
          ],
          "userNames": [
            "GeneratedFindingUserName"
          ]
        },
        "sample": true
      },
      "eventFirstSeen": "2021-04-29T23:27:30.091Z",
      "eventLastSeen": "2021-04-29T23:27:30.091Z",
      "archived": false,
      "count": 1
    },
    "severity": 8,
    "createdAt": "2021-04-29T23:27:30.091Z",
    "updatedAt": "2021-04-29T23:27:30.091Z",
    "title": "API GeneratedFindingAPIName was invoked from an IP address on a custom threat list.",
    "description": "An API was used to access a bucket from an IP address on a custom threat list."
  }
]